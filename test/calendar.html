<!DOCTYPE html>
<html lang="zh-cn">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
	<meta content="fullscreen=yes,preventMove=no" name="ML-Config">
	<title>test</title>
<script type="text/javascript" src="../js/jquery.min.js"></script>
<!--	<script type="text/javascript" src="../js/qmik.min.js"></script>-->

<style type="text/css">
.calendar-wrap {width:350px;height: auto; margin: 0 auto;border:1px solid #ddd;}
.calendar-wrap ul {overflow: hidden;padding: 0;margin: 0;}
.calendar-wrap ul li {list-style: none; display: inline-block;float:left; width: 50px; height:50px;border: 1px solid #ddd;box-sizing: border-box;}
.calen-head, .calen-week {border-bottom: 1px solid #ddd;}
.calen-days .outday {color: #999;}
.calen-head {width: 100%;height:40px; line-height:40px;overflow: hidden;}
.calen-head span {display: inline-block;float: left; text-align: center;}
.month-up, .month-down {width: 20%; cursor: pointer;}
.month-up:hover, .month-down:hover {background: #eee;}
.month-year {width: 60%;}
</style>
</head>
<body>
<div class="calendar-wrap">
	<div class="calen-head">
		<span class="month-up"> < </span>
		<span class="month-year"></span>
		<span class="month-down"> > </span>
	</div>
	<div class="calen-body">
		<ul class="calen-week">
			<li>日</li><li>一</li><li>二</li><li>三</li><li>四</li><li>五</li><li>六</li>
		</ul>
		<ul class="calen-days">
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
			<li></li>
		</ul>
	</div>
</div>

<script>
var calendar = (function(){
	var calen = function(){},
	config = {
	},
	util = {
		today: function(){
			return new Date();
		},
		getMonthDays: function(yy, mm){ //获取某年某月有多少天
			var date = new Date();
			date.setFullYear(yy);
			date.setMonth(mm);
			date.setDate(0);
			var days = date.getDate();
			return days;
		},
		getMonthOne: function(yy, mm){ //获取某年某月第一天是星期几
			var date = new Date();
			date.setFullYear(yy);
			date.setMonth(mm-1);
			date.setDate(1);
			var week = date.getDay();
			return week;
		},
		getNYearMonth: function(yy, mm, n){
			if(n > 0){
				if(mm + n > 12){
					mm = 1;
					yy++;
				} else {
					mm++;
				}
			} else {
				if(mm + n <= 0){
					mm = 12;
					yy--;
				} else {
					mm--;
				}
			}
			return {
				YY: yy,
				MM: mm
			};
		}
	},
	events = {
		setHeaderYM: function(yy, mm){
			$('.month-year').text(yy + "-" + mm);
		},
		createDay: function(yy, mm){
			events.setHeaderYM(yy, mm);
			var firstday = util.getMonthOne(yy, mm);
			var days = util.getMonthDays(yy, mm);
			var alldays = $('.calen-days li');
			//上月
			var pre = util.getNYearMonth(yy, mm, -1);			
			var preMonthDays = util.getMonthDays(pre.YY, pre.MM);
			for(var i=0; i <= firstday; i++){
				$(alldays[firstday-i-1]).text(preMonthDays-i).addClass('outday');
			}
			//本月
			for(var i=0; i < days; i++){
				var theDay = $(alldays[firstday+i]);
				theDay.text(i+1);
				if(theDay.hasClass('outday')){
					theDay.removeClass('outday');
				}
			}
			//下月
			var xx = parseInt(firstday+days);
			var next = util.getNYearMonth(yy, mm, 1);
			for(var i=0; i <= 42-firstday-days; i++){
				$(alldays[xx+i]).text(i+1).addClass('outday');
			}			
		},
		turnMonth: function(n){
			var ymArr = $('.month-year').text().split('-'),
				year = parseInt(ymArr[0]),
				month = parseInt(ymArr[1]);
			if(n != 0){
				var xday = util.getNYearMonth(year, month, n);
				year = xday.YY;
				month = xday.MM;
			}
			events.createDay(year, month);
		},
		dayOnclick: function(dom){
			var yearMonth = $('.month-year').text();
			var day = $(dom).text();
			alert(yearMonth + "-" + day);
		}
	},
	dialog = function(){
		$('.month-up').on('click', function(){
			events.turnMonth(-1);
		});
		$('.month-down').on('click', function(){
			events.turnMonth(1);
		});
		$('.calen-days li').on('click', function(){
			events.dayOnclick(this);
		});
	};
	calen.setDay = function(){
		var now = new Date();
		var yy = now.getFullYear(), mm = now.getMonth();
		events.createDay(yy, mm+1);
		dialog();
	};
	return calen;
})();
calendar.setDay();
</script>
</body>
</html>